{
  "$schema": "https://opencode.ai/config.json",
  "model": "anthropic/claude-opus-4-6",
  "small_model": "anthropic/claude-haiku-4-5",
  "default_agent": "build",
  "instructions": [".opencode/instructions/INSTRUCTIONS.md"],
  "command": {
    "plan": {
      "description": "Create a detailed implementation plan for complex features",
      "template": "{file:commands/plan.md}\n\n$ARGUMENTS",
      "agent": "plan",
      "subtask": true
    },
    "code-review": {
      "description": "Review code for quality, patterns, and maintainability",
      "template": "{file:commands/code-review.md}\n\n$ARGUMENTS",
      "agent": "code-reviewer",
      "subtask": true
    },
    "security": {
      "description": "Run security-focused review (OWASP, auth, tenant isolation)",
      "template": "{file:commands/security.md}\n\n$ARGUMENTS",
      "agent": "security-reviewer",
      "subtask": true
    },
    "go-review": {
      "description": "Go-focused code review (idioms, concurrency, performance)",
      "template": "{file:commands/go-review.md}\n\n$ARGUMENTS",
      "agent": "go-reviewer",
      "subtask": true
    },
    "db-review": {
      "description": "Review PostgreSQL schema, queries, migrations, and RLS policies",
      "template": "{file:commands/db-review.md}\n\n$ARGUMENTS",
      "agent": "database-reviewer",
      "subtask": true
    },
    "build-fix": {
      "description": "Fix Go and/or TypeScript build errors with minimal changes",
      "template": "{file:commands/build-fix.md}\n\n$ARGUMENTS",
      "agent": "build-fixer",
      "subtask": true
    },
    "go-build": {
      "description": "Fix Go build, vet, and compilation errors",
      "template": "{file:commands/go-build.md}\n\n$ARGUMENTS",
      "agent": "go-build-resolver",
      "subtask": true
    },
    "tdd": {
      "description": "Enforce TDD workflow with 80%+ test coverage",
      "template": "{file:commands/tdd.md}\n\n$ARGUMENTS",
      "agent": "tdd-guide",
      "subtask": true
    },
    "go-test": {
      "description": "Go TDD workflow with table-driven tests",
      "template": "{file:commands/go-test.md}\n\n$ARGUMENTS",
      "agent": "tdd-guide",
      "subtask": true
    },
    "e2e": {
      "description": "Generate and run E2E tests with Playwright",
      "template": "{file:commands/e2e.md}\n\n$ARGUMENTS",
      "agent": "e2e-runner",
      "subtask": true
    },
    "test-coverage": {
      "description": "Analyze test coverage across Go backend and Next.js frontend",
      "template": "{file:commands/test-coverage.md}\n\n$ARGUMENTS",
      "agent": "tdd-guide",
      "subtask": true
    },
    "verify": {
      "description": "Run comprehensive verification (Go build + vet, Next.js build, lint, tests)",
      "template": "{file:commands/verify.md}\n\n$ARGUMENTS"
    },
    "checkpoint": {
      "description": "Create or verify workflow checkpoint",
      "template": "{file:commands/checkpoint.md}\n\n$ARGUMENTS"
    },
    "update-docs": {
      "description": "Update architecture and API documentation",
      "template": "{file:commands/update-docs.md}\n\n$ARGUMENTS",
      "agent": "doc-updater",
      "subtask": true
    },
    "migrate": {
      "description": "Create or review database migrations with goose",
      "template": "{file:commands/migrate.md}\n\n$ARGUMENTS",
      "agent": "database-reviewer",
      "subtask": true
    },
    "orchestrate": {
      "description": "Orchestrate multiple agents for complex cross-stack tasks",
      "template": "{file:commands/orchestrate.md}\n\n$ARGUMENTS",
      "agent": "plan",
      "subtask": true
    },
    "refactor-clean": {
      "description": "Remove dead code and consolidate duplicates",
      "template": "{file:commands/refactor-clean.md}\n\n$ARGUMENTS",
      "agent": "refactor-cleaner",
      "subtask": true
    },
    "learn": {
      "description": "Extract patterns and instincts from current session",
      "template": "{file:commands/learn.md}\n\n$ARGUMENTS"
    },
    "instinct-status": {
      "description": "View learned instincts with confidence scores",
      "template": "{file:commands/instinct-status.md}\n\n$ARGUMENTS"
    },
    "instinct-import": {
      "description": "Import instincts from external sources",
      "template": "{file:commands/instinct-import.md}\n\n$ARGUMENTS"
    },
    "instinct-export": {
      "description": "Export instincts for sharing",
      "template": "{file:commands/instinct-export.md}\n\n$ARGUMENTS"
    },
    "evolve": {
      "description": "Cluster related instincts into skills",
      "template": "{file:commands/evolve.md}\n\n$ARGUMENTS"
    },
    "session-notes": {
      "description": "Generate session notes (work log + continuity context)",
      "template": "{file:commands/session-notes.md}\n\n$ARGUMENTS"
    },
    "worktree": {
      "description": "Manage git worktrees for parallel multi-agent development",
      "template": "{file:commands/worktree.md}\n\n$ARGUMENTS"
    },
    "review-battle": {
      "description": "Dispatch competing code reviewers, then grade them",
      "template": "{file:commands/review-battle.md}\n\n$ARGUMENTS"
    }
  },
  "agent": {
    "plan": {
      "description": "Planning and architecture specialist. Implementation plans, design decisions, cross-stack feature breakdowns.",
      "mode": "all",
      "model": "anthropic/claude-opus-4-6",
      "temperature": 0.1,
      "steps": 25,
      "prompt": "{file:prompts/planner.txt}",
      "permission": {
        "edit": {
          "*": "deny",
          ".plans/*": "allow"
        },
        "bash": {
          "*": "deny",
          "git log*": "allow",
          "git worktree*": "allow",
          "git diff*": "allow",
          "git show*": "allow",
          "ls *": "allow",
          "find *": "allow",
          "mkdir -p .plans": "allow"
        }
      }
    }
  },
  "mcp": {
    "context7": {
      "type": "remote",
      "url": "https://mcp.context7.com/mcp",
      "enabled": true
    },
    "postgres": {
      "type": "local",
      "command": [
        "npx",
        "-y",
        "@modelcontextprotocol/server-postgres",
        "{{DATABASE_URL}}"
      ],
      "enabled": false
    }
  },
  "permission": {
    "bash": {
      "*": "ask",
      "go build*": "allow",
      "go test*": "allow",
      "golangci-lint*": "allow",
      "gitleaks*": "allow",
      "npm run build*": "allow",
      "npx eslint*": "allow",
      "npx vitest*": "allow",
      "git status*": "allow",
      "git diff*": "allow",
      "git log*": "allow",
      "docker logs*": "allow",
      "docker restart*": "allow",
      "ls*": "allow",
      "sleep": "allow"
    },
    "mcp": {
      "postgres_*": "ask"
    }
  }
}
